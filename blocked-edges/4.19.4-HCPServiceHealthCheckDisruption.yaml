to: 4.19.4
from: 4.18[.].*
fixedIn: 4.19.5
url: https://issues.redhat.com/browse/CNTRLPLANE-1110
name: HCPServiceHealthCheckDisruption
message: |-
  When Hosted Control Plane (HCP/HyperShift) clusters running on AWS update the control plane, the Services of type
  LoadBalancer may experience temporary availability disruption because health checks are not set up properly to monitor
  Node readiness state.
matchingRules:
  - type: PromQL
    promql:
      promql: |
        (
          group by (_id, invoker) (cluster_installer{_id="",invoker="hypershift"})
          or
          0 * group by (_id, invoker) (cluster_installer{_id=""})
        )
        and on (_id) (
          group by (type) (cluster_infrastructure_provider{_id="",type="AWS"})
        )
        or on (_id) (
          0 * group by (type) (cluster_infrastructure_provider{_id=""})
        )
